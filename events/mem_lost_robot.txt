######################################
# Lost Robot
# Code by:          Tuttu
# Writing by:       Tuttu
######################################

namespace = mem_lost_robot

# Initial event. Triggered by on_action "on_yearly_pulse"
planet_event = {
	id = mem_lost_robot.1
	title = "mem_lost_robot.1.name"
	desc = "mem_lost_robot.1.desc"
	picture = GFX_evt_space_station
	show_sound = event_alien_signal #TODO : change this sound
	location = ROOT

	is_triggered_only = yes

	trigger = {		
		NOT = { has_planet_flag = colony_event }
		is_colony = yes
		is_moon = no		
		has_moon = yes		
		any_moon = {
			habitable_planet = no
			has_resource = { type = minerals amount > 0 }
			has_mining_station = yes
		}

		Root.Owner = {
			is_country_type = default
			has_technology = tech_robotic_workers
			NOR = {
				has_country_flag = mem_lost_robot_done
				has_authority = auth_hive_mind
			}			
		}
	}

	# Used for easier localization and planet selection
	immediate = {
		save_event_target_as = mem_lost_robot_planet
		Root.Owner = { set_country_flag = mem_lost_robot_done }
		set_planet_flag = colony_event
		
		random_moon = {
			limit = {
				habitable_planet = no
				has_resource = { type = minerals amount > 0 }
				has_mining_station = yes
			}
			save_event_target_as = mem_lost_robot_moon
		}
	}

	# Retrieve the robot
	option = {		
		name = "mem_lost_robot.1.accept"
		hidden_effect = {
			planet_event = { id = mem_lost_robot.10 days = 10 random = 2 }
		}
	}

	# We don't care
	option = {
		name = "mem_lost_robot.1.deny"
		hidden_effect = {
			planet_event = { id = mem_lost_robot.11 days = 10 random = 2 } # TODO : Change event ID to match mining machine use
		}
	}
}

planet_event = {
	id = mem_lost_robot.10
	title = "mem_lost_robot.10.name"
	desc = "mem_lost_robot.10.desc"
	picture = GFX_evt_space_hangar
	show_sound = event_alien_signal #TODO : change this sound
	location = ROOT

	is_triggered_only = yes

	# Check the cargo
	option = {		
		name = "mem_lost_robot.10.cargo"
		hidden_effect = {
			planet_event = { id = mem_lost_robot.11 days = 10 random = 2 }
		}
	}

	# Check the factory
	option = {		
		name = "mem_lost_robot.10.factory"
		hidden_effect = {
			planet_event = { id = mem_lost_robot.12 days = 10 random = 2 }
		}
	}
}